\documentclass[11pt]{article}

\usepackage[letterpaper, margin=0.7in]{geometry}
\usepackage{graphicx}
\usepackage{subcaption}
\usepackage{cleveref}
\usepackage{listings}
\usepackage{multicol}
\usepackage{tikz}
\usepackage{bm}
\usepackage{minted}
\usetikzlibrary{arrows}
\usepackage{wrapfig}
\usepackage{amsmath}
\usepackage{amssymb}
\usepackage[section]{placeins}
\usepackage{pgfplots,wrapfig}  
\pgfplotsset{compat=newest} 
\pgfplotsset{plot coordinates/math parser=false} 
\newlength\figureheight 
\newlength\figurewidth 
\setlength{\parindent}{0pt}

\begin{document}

\begin{center}

COMP6212 Assignment 1 : Shakib-Bin Hamid 25250094 sh3g12

\end{center}

\section{Efficient Frontier}

Let a portfolio of $N$ assets be $\bm{\pi}$, whose expected return is $\bm{\mu}$ and the 
co-variance is $\bm{\Sigma}$. \\

\subsection{Efficient Frontier with 3 Assets}

\begin{wrapfigure}{!h}{0.45\textwidth}
	\vspace{-2cm}
  \begin{center}
    \resizebox {0.4\textwidth} {!} {\input{q1_a_efficient_frontier.tex} }
	\caption{Efficient Portfolio}
	\label{fig:q1-a-efficient-portfolio}
  \end{center}
	\vspace{-1cm}
\end{wrapfigure}

According to the paper, the expected return of the portfolio, 
$E = \sum_{i=1}^N\pi_i\mu_i = \bm{\pi}^t\bm{\mu}$. The risk is analogous to the variance of
the returns, i.e. $V = \sum_{i=1}^N\sum_{j=1}^N\sigma_{ij}\pi_i\pi_j = \bm{\pi}^t\bm{\Sigma}\bm{\pi}$.\\

Given $\bm{\mu} = \bm{m}$ and $\bm{\Sigma} = \bm{C}$ for a $3$ assets, we can generate 100 random
portfolios, where each portfolio $\bm{\pi} = (\pi_1 \pi_2 \pi_3)^t$ s.t. $\bm{1}^t\bm{\pi} = 1$ by
\mintinline{matlab}|y=randn(3,1); y=y/norm(y,1)|. Then we can calculate $E-V$ for each of the portfolios by
\mintinline{matlab}|E=y'*m; V=sqrt(y'*C*y)|.\\

Finally I make the scatter plot and on the same figure I plot the efficient frontier using
\mintinline{matlab}|estimateFrontier| function. As expected all the random portfolios were on the
correct one side of the frontier. 

\subsection{Efficient Frontier with 2 Assets}

To prepare three 2 asset porfolios, we remove the data points that are not necessary, i.e. that has
the third asset. First I plotted random returns generated by the 2 asset mean and variance using
\mintinline{matlab}|mvnrnd|. As can be noticed from Figure \ref{fig:q1-b-return-distribution}, asset
2 and 3 are almost uncorrelated, asset 1 and 2 are negatively correlated, asset 1 and 3 are positively
correlated.\\

\begin{figure}[!h]
	\vspace{-0.5cm}
	\centering 
	\resizebox {0.7\textwidth} {!} {\input{q1_b_return_distribution.tex} }
	\caption{Distribution of 2 Asset Returns}
	\label{fig:q1-b-return-distribution}
	\vspace{-0.5cm}
\end{figure}

As done previously with all three assets, I generate 100 random portfolios for each of the three 2 asset
combinations and plot the $E-V$ scatters along with the efficient frontiers. Notice that in case of 2 asset portfolios, every portfolio construction is efficient and the frontier
has a bend, i.e. risk increases for the lowest returns.\\

\begin{figure}[!h]
   \centering 
   \begin{subfigure}[b]{0.23\textwidth}
     	\resizebox {\textwidth} {!} {\input{q1_b_efficient_frontier_1.tex} }
		\label{fig:q1-b-efficient-frontier-1}
    \end{subfigure}
    ~
    \begin{subfigure}[b]{0.23\textwidth}
       	\resizebox {\textwidth} {!} {\input{q1_b_efficient_frontier_2.tex} }
        \label{fig:q1-b-efficient-frontier-2}
    \end{subfigure}
	~
    \begin{subfigure}[b]{0.23\textwidth}
       	\resizebox {\textwidth} {!} {\input{q1_b_efficient_frontier_3.tex} }
        \label{fig:q1-b-efficient-frontier-3}
    \end{subfigure}
	~
    \begin{subfigure}[b]{0.23\textwidth}
       	\resizebox {\textwidth} {!} {\input{q1_b_efficient_frontier_all.tex} }
        \label{fig:q1-b-efficient-frontier-all}
    \end{subfigure}
	\vspace{-0.5cm}
    \caption{Efficient Frontier for 2 Asset Portfolios}\label{fig:naive_v_cvx}
\end{figure}

\subsection{Use of \texttt{linprog} in NaiveMV}

In order to calculate the efficient frontier, we need two extreme points - maximum return for a 
portfolio regardless of the risk and minimum risk regardless of the return. For the first case, we have
$E = \underset{w}{max}(\bm{\pi}^t\bm{\mu})$ s.t. $\bm{1}^t\bm{\pi} = 1$ which gives the portfolio that 
maximises the return regardless of the risk. We can then calculate $E-V$ for this portfolio, thus giving
us the top corner of the $E-V$ graphs here. This is a linear equation of $\bm{\pi}$. Matlab's
\mintinline{matlab}|linprog| function can solve linear equation can solve such equations of the following form -

\begin{minipage}{.4\textwidth}
  	\[
		\underset{x}{min}(f^tx) s.t. 
	\begin{cases}
		A.x \leq b\\
		A_{eq}.x = b_{eq}\\
		lb \leq x \leq ub
	\end{cases}
	\]
\end{minipage}% This must go next to `\end{minipage}`
\begin{minipage}{.6\textwidth}
  	\mintinline{matlab}|f=-ERet;A=[];b=[];Aeq=ones(1,N);beq=1;lb=0;ub=1|
\end{minipage}

However, to calculate the portfolio that minimises the risk we need to solve a quadratic equation of 
$\bm{\pi}$, $\underset{w}{mim}(\bm{\pi}^t\bm{\Sigma}\bm{\pi})$ s.t. $\bm{1}^t\bm{\pi} = 1$. In this case we use the
\mintinline{matlab}|quadprog| function. Finally, we choose $N$ expected returns between the two extreme
points and calculate the porfolio that minimises the risk while achieving the chosen expected returns.
Thus the efficient portfolio is created.

\subsection{Efficient Frontier : NaiveMV vs CVX}

Using the CVX tool we can declarively perform the convex optimisations we performed earlier with
\mintinline{matlab}|linprog| and \mintinline{matlab}|quadprog|, as follows -

\vspace{0.5cm}

\begin{minipage}{.4\textwidth}
  	\begin{minted}{matlab}
	cvx_begin quiet
		variable w(N,1)
		minimize( -ERet'*w )
		subject to
			ones(1,N)*w == 1;
			w >= zeros(N,1);
	cvx_end
	\end{minted}
\end{minipage}% This must go next to `\end{minipage}`
\begin{minipage}{.6\textwidth}
  	\begin{minted}{matlab}
	cvx_begin quiet
		variable w(N,1)
		minimize( 0.5*w'*ECov*w + zeros(N,1)'*w)
		subject to
			ones(1,N) * x == 1;
			x >= zeros(N,1);
	cvx_end
	\end{minted}
\end{minipage}

\begin{figure}[!h]
    \centering 
   \begin{subfigure}[b]{0.30\textwidth}
     	\resizebox {\textwidth} {!} {\input{q1_d_naive_v_cvx.tex} }
     \caption{Similarity}
    \label{fig:q1-d-naive-v-cvx}
    \end{subfigure}
    ~
    \begin{subfigure}[b]{0.30\textwidth}
       	\includegraphics[scale=.5] {q1_d_naive_v_cvx_difference.eps}
       \caption{Difference}
        \label{fig:q1-d-naive-v-cvx-difference}
    \end{subfigure}
    \caption{NaiveMV vs Using CVX}\label{fig:naive_v_cvx}
\end{figure}

The results are extremely similar, since differences only show up in $10^{-7}$ scale. However, the
CVX tool was noticeably slower.

\end{document}



















